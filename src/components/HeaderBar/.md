# 自定义导航 HeaderBar 组件使用文档

## 简介

HeaderBar 是一个适用于 Vue3 + TypeScript 的自定义导航栏组件，支持多平台（H5、APP、微信小程序等），提供了灵活的配置选项和响应式设计。

## 安装

将组件文件放入你的项目组件目录中，例如 `components/HeaderBar.vue`

## 引入与基本使用

```vue
<template>
  <HeaderBar 
    :BarTitle="pageTitle"
    :Back="true"
  />
</template>

<script setup lang="ts">
import HeaderBar from '@/components/HeaderBar.vue';
import { ref } from 'vue';

const pageTitle = ref('首页');
</script>
```

## Props 配置

| 参数名 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| Config | `Partial<Config>` | 见下方默认配置 | 导航栏的样式配置 |
| homePath | `string` | '/pages/index/home' | 首页路径，用于返回首页功能 |
| scrollTop | `number` | 0 | 滚动高度，用于控制透明度变化 |
| BarTitle | `string` | 'navigationBar' | 导航栏标题 |
| showbgImg | `boolean` | false | 是否显示背景图片 |
| OpacityScroll | `boolean` | false | 是否随滚动改变透明度 |
| Back | `boolean` | true | 是否显示返回按钮 |

### Config 接口默认值

```typescript
{
  indexBgHid: false,       // 是否隐藏索引背景
  backgroundColor: '#fff', // 背景颜色
  color: '#333333',        // 文字颜色
  bgUrl: ''                // 背景图片URL
}
```

## 事件

组件内部已处理返回逻辑，无需额外绑定事件。点击返回按钮时：
- 如果是第一个页面，会跳转到 `homePath` 配置的首页
- 如果不是第一个页面，会返回上一页

## 插槽

组件提供默认插槽，可以自定义导航栏内容：

```vue
<HeaderBar>
  <template #default>
    <!-- 自定义导航栏内容 -->
    <view class="custom-title">我的自定义标题</view>
    <view class="custom-right">
      <button>操作</button>
    </view>
  </template>
</HeaderBar>
```

## 特殊功能

### 1. 滚动透明度效果（Uniapp 页面滚动实现）

通过设置 `OpacityScroll` 为 `true` 并结合 Uniapp 页面滚动事件，可以实现导航栏随滚动改变透明度的效果：

```vue
<template>
  <view class="container">
    <HeaderBar 
      BarTitle="动态透明导航"
      :OpacityScroll="true"
      :scrollTop="scrollTop"
      :Config="{
        backgroundColor: '#2c3e50',
        color: '#ffffff'
      }"
    />
    
    <!-- 页面内容区域 -->
    <view class="content">
      <!-- 这里放置你的页面内容 -->
      <view class="scroll-area" v-for="i in 50" :key="i">
        内容区域 {{ i }}
      </view>
    </view>
  </view>
</template>

<script setup lang="ts">
import HeaderBar from '@/components/HeaderBar.vue';
import { ref, onPageScroll } from 'vue';

// 存储滚动高度
const scrollTop = ref(0);

// 监听页面滚动事件（Uniapp 提供）
onPageScroll((e) => {
  // e.scrollTop 为页面滚动距离
  scrollTop.value = e.scrollTop;
});
</script>

<style scoped>
.container {
  min-height: 100vh;
}

.content {
  padding-top: 100rpx; /* 避免内容被导航栏遮挡 */
}

.scroll-area {
  height: 200rpx;
  display: flex;
  align-items: center;
  justify-content: center;
  border-bottom: 1px solid #eee;
}
</style>
```

实现原理：
- 使用 Uniapp 提供的 `onPageScroll` 钩子监听页面滚动事件
- 将滚动距离 `scrollTop` 传递给 HeaderBar 组件
- 组件内部根据滚动距离计算透明度（滚动距离 >= 1px 时完全不透明）

### 2. 背景图片展示

设置 `showbgImg` 为 `true` 并在 `Config` 中配置 `bgUrl` 可以显示背景图片：

```vue
<HeaderBar 
  BarTitle="带背景图的导航"
  :showbgImg="true"
  :Config="{
    bgUrl: '/static/images/header-bg.png',
    color: '#ffffff'
  }"
/>
```

## 平台适配

组件通过条件编译适配不同平台：
- H5/APP 平台
- 微信小程序/其他小程序平台

会自动根据不同平台调整导航栏高度、状态栏等样式，无需手动适配。

## 样式自定义

可以通过以下方式自定义组件样式：

1. 使用 `Config` 属性配置基本颜色
2. 通过深度选择器修改组件内部样式：

```scss
::v-deep .header_title {
  font-weight: bold;
}

::v-deep .icon {
  color: #ff0000;
}
```

## 示例

### 示例1：基础导航栏

```vue
<HeaderBar 
  BarTitle="用户中心"
  :Back="true"
/>
```

### 示例2：带背景图的导航栏

```vue
<HeaderBar 
  BarTitle="详情页面"
  :showbgImg="true"
  :Config="{
    bgUrl: '/static/bg.jpg',
    color: '#fff',
    backgroundColor: 'transparent'
  }"
/>
```

### 示例3：自定义导航内容

```vue
<HeaderBar>
  <template #default>
    <view class="left-btn" @click="handleLeftClick">
      <text class="iconfont">←</text>
    </view>
    <view class="title">自定义导航</view>
    <view class="right-btn" @click="handleRightClick">
      <text class="iconfont">⋮</text>
    </view>
  </template>
</HeaderBar>

<script setup lang="ts">
const handleLeftClick = () => {
  // 自定义返回逻辑
  uni.navigateBack();
};

const handleRightClick = () => {
  // 自定义右侧按钮逻辑
  console.log('点击了更多按钮');
};
</script>

<style scoped>
.left-btn, .right-btn {
  width: 100rpx;
  height: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
}

.title {
  flex: 1;
  text-align: center;
  font-size: 36rpx;
  font-weight: bold;
}
</style>
```