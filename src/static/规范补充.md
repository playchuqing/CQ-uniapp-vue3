# UniApp 小程序与 H5 前端开发规范指南
## 一、视图规范
### （一）id/class 命名规则
1. **合理使用缩写**：在不影响语义理解的前提下，可适当对表示结构的词汇使用缩写，如`col`（column）、`nav`（navigation）、`btn`（button）等，禁止自行编造不常见缩写。


### （二）语法规则
1. **属性引号**：所有属性定义必须统一使用双引号，示例：
   - `class="container"`
   - `id="main-content"`
   - `style="color: red;"`
   - `v-if="isShow"`
   - `v-show="hasPermission"`
   - `@click="handleClick()"`
   严禁使用单引号。

2. **点击事件括号**：`@click`点击事件绑定的方法必须加括号，如`@click="preview()"`，确保方法正确执行。

3. **图标选择**：优先使用已有的`icon`图标，避免重复使用图片，减少资源加载量、提升开发效率。

4. **条件判断优化**：View 中存在多个条件判断时，需将逻辑提取到`computed`计算属性中，处理后返回结果再在视图中使用，提升代码可读性与可维护性。  
   示例：
   ```javascript
   computed: {
     // 提取多条件判断逻辑：表单必填项已填且未处于提交中，才显示提交按钮
     showSubmitBtn() {
       return this.form.name && this.form.phone && !this.isSubmitting;
     }
   }
   ```
   ```html
   <!-- 视图中直接使用计算属性，无需重复写判断 -->
   <button @click="submit()" v-if="showSubmitBtn">提交</button>
   ```

5. **图片宽高设置**：`View`中的`image`标签需分场景适配，兼顾视觉稳定性与布局灵活性：
   - **场景1：固定比例图（如商品卡、头像）**  
     优先用“父容器定宽+`padding-top`控比例+图片绝对定位”，避免首次加载拉伸，示例：
     ```html
     <!-- 父容器定宽+1:1比例 -->
     <view class="img-box">
       <image class="img" :src="imgUrl" mode="aspectFill"></image>
     </view>
     <style>
     .img-box {
       width: 200rpx; /* 父容器定宽，也可设width:100%撑满外层 */
       position: relative;
       overflow: hidden;
       padding-top: 100%; /* 1:1比例，4:3图设75%，16:9图设56.25% */
     }
     .img {
       position: absolute;
       top: 0; 
       left: 0;
       width: 100%; 
       height: 100%; /* 填充父容器 */
     }
     </style>
     ```
   - **场景2：父盒撑满且高度自适应（如富文本插图）**  
     可使用`widthfix`，但需加骨架屏/默认背景占位，防止加载跳动，示例：
     ```html
     <!-- 父盒撑满+widthfix自适应，搭配骨架屏 -->
     <view class="rich-img-wrap">
       <!-- 加载中：骨架屏占位 -->
       <view class="img-skeleton" v-if="!isLoaded"></view>
       <!-- 加载完成：widthfix自适应高度 -->
       <image 
         v-else 
         class="rich-img" 
         :src="imgUrl" 
         mode="widthfix"
         @load="isLoaded = true"
       ></image>
     </view>
     <style>
     .rich-img-wrap { width: 100%; } /* 父盒撑满外层 */
     .img-skeleton {
       width: 100%;
       height: 300rpx; /* 预设占位高度，匹配常见图片比例 */
       background: #f5f5f5;
     }
     .rich-img { width: 100%; } /* widthfix需配合width:100% */
     </style>
     ```

6. **v-for 与 key 配对**：使用`v-for`进行列表渲染时，必须同时设置`key`值（`key`用于帮助 Vue.js 更高效地更新虚拟 DOM，提升渲染性能），示例：
   ```html
   <view v-for="(item, index) in list" :key="item.id">{{ item.name }}</view>
   ```
   严禁遗漏`key`。


### （三）属性顺序
按以下优先级排列标签属性，提升代码可读性：
1. **核心属性优先**：`class`（第一位，用于高可复用组件设计）→ `id`/`name`（第二位，相对具体且尽量少用）→ `style`；
2. **Vue 指令其次**：`v-for`、`v-if`、`v-show`等；
3. **事件属性随后**：`@click`、`@change`、`@input`等；
4. **其他属性最后**：UniApp 特定属性（`value`、`src`、`title`等）、自定义属性；若组件包含插槽（Slot），插槽内容需位于元素最后部分。

> 补充说明：
> - 布尔型属性声明时可不赋值，如`<input disabled>`；
> - 行内样式`style`应尽量少用，提升代码可维护性与性能。


### （四）注释规范
在关键代码块、复杂逻辑处、可能影响他人理解代码意图的位置，必须添加清晰、简洁的注释，需包含“功能描述+参数说明（如有）+返回值说明（如有）”。  
示例：
```javascript
// 功能：调用获取用户信息接口（无需传参）
// 返回值：Promise 对象，成功时返回 {name: 用户名, avatar: 头像地址, phone: 手机号}，失败时返回错误信息
getUserInfo() {
    return new Promise((resolve, reject) => {
        uni.request({
            url: 'https://example.com/api/user/info',
            success: (res) => {
                resolve(res.data);
            },
            fail: (err) => {
                reject(err);
            }
        });
    });
}
```


## 二、样式语言规范
UniApp 开发中推荐使用`scss`作为样式表语言（`css`、`less`也支持），通过`scoped`属性声明的样式具有作用域，仅作用于当前组件。


### （一）CSS 属性穿透使用
当需要修改子组件/第三方组件（如 UniUI、Vant）内部样式时，需在`scoped`样式下使用属性穿透，三种常用方式对比如下：

| 穿透方式 | 适用场景 | 兼容性 | 示例 |
|----------|----------|--------|------|
| `::v-deep` | Vue 通用场景，优先推荐 | 较好（支持 H5、小程序） | `::v-deep .u-button__text { color: #007aff; }`（修改 UniUI 按钮文字颜色） |
| `/deep/` | 功能与`::v-deep`一致 | 部分低版本浏览器兼容差 | 不推荐优先使用 |
| `:deep()` | Vue3 推荐新写法 | UniApp 3.x+ 支持 | `:deep(.van-cell__value) { color: #999; }`（修改 Vant 单元格右侧文字颜色） |

> 注意事项：
> 1. 穿透样式需精准定位类名（避免用`div`、`span`等通用标签），防止影响其他组件样式；
> 2. 仅在必要时使用穿透，优先通过组件自身`props`修改样式；
> 3. `::v-deep`是 Vue 官方推荐的更标准写法，需根据项目目标浏览器选择。


## 三、多端兼容规范
### （一）平台特定代码处理
UniApp 支持通过**条件编译**编写针对特定平台的代码，常用平台标识：`H5`（网页端）、`APP-PLUS`（App 端）、`MP-WEIXIN`（微信小程序）等，具体用法如下：

1. **JS 代码**
   ```javascript
   // #ifdef H5 || APP-PLUS
   // 仅在 H5 和 App 平台执行
   console.log('当前环境：H5 或 App');
   // #endif

   // #ifndef H5
   // 不在 H5 平台执行（即小程序、App 等平台执行）
   console.log('当前环境：非 H5');
   // #endif
   ```

2. **组件代码**
   ```html
   <!-- #ifdef H5 -->
   <!-- 仅在 H5 平台显示 -->
   <view class="h5-only">H5 平台独有的组件</view>
   <!-- #endif -->

   <!-- #ifdef MP-WEIXIN -->
   <!-- 仅在微信小程序显示 -->
   <view class="wx-only">微信小程序独有的组件</view>
   <!-- #endif -->
   ```

3. **样式代码**
   ```css
   /* #ifdef H5 */
   /* 仅在 H5 平台生效 */
   .h5-style {
       color: #f00;
   }
   /* #endif */

   view {
       /* #ifdef MP-WEIXIN */
       /* 仅在微信小程序生效 */
       font-size: 28rpx;
       /* #endif */
   }
   ```


### （二）资源加载与适配
1. **图片资源**
   - 小程序不支持在`css`中使用本地背景图和字体文件；
   - H5 平台：小于 4kb 的资源会自动转换为`base64`格式，若需关闭该功能，可在`vue.config.js`中配置；
   - UniApp 支持在`template`中嵌套`<template/>`和`<block/>`，用于列表渲染和条件渲染。

2. **尺寸单位**
   - 推荐统一使用`rpx`作为尺寸单位（适配不同设备屏幕），UniApp 规定屏幕基准宽度为 750rpx；
   - 换算公式：`UniApp 中元素宽度（rpx）= 750 * 设计稿元素宽度（px）/ 设计稿总宽度（px）`；
     - 示例1：设计稿宽度 750px，元素宽度 100px → UniApp 中设为 100rpx；
     - 示例2：设计稿宽度 375px，元素宽度 200px → UniApp 中设为 `750*200/375 = 400rpx`；
   - 特殊情况：App 端`pages.json`的`titleNView`、页面中使用`plus api`涉及的单位，仅支持`px`，不支持`rpx`。

3. **字体设置**
   - 如需多端统一字体，可通过 CSS 自定义字体，并结合条件编译针对不同平台微调，确保显示效果一致。